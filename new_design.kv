#:kivy 2.1.0

Screen:
    MDTopAppBar:
        id: toolbar
        pos_hint: {'top': 1}
        title: 'Navigation'
        left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]

    NavigationSideBar:
        id: sidebar
        x: toolbar.width
        size_hint_y: 1.0 - toolbar.height/root.height

        AppScreenManager:
            id: screen_manager
            current: 'intro_screen' if app.condition else 'login_screen'
            PasswordGeneratorScreen:
            IntroScreen:   
            LoginScreen:

        MDNavigationDrawer:
            id: nav_drawer
            NavigationContent:
                screen_manager: screen_manager
                nav_drawer: nav_drawer           
                
<NavigationContent>:
    first_item: first_item
    list_items: list_items
    MDScrollView:
        pos_hint: {'center_y': .5}
        adaptive_height: True
        MDList:
            id: list_items

            OneLineListItem:
                id: first_item
                text: 'Intro screen'
                on_release:
                    root.nav_drawer.set_state("close")
                    root.screen_manager.current = 'intro_screen'

            OneLineListItem:
                text: "Login screen"
                on_release:
                    root.nav_drawer.set_state("close")
                    root.screen_manager.current = 'login_screen'

            OneLineListItem:
                text: "Password generator screen"
                on_release:
                    root.nav_drawer.set_state("close")
                    root.screen_manager.current = 'password_generator_screen'
            

<IntroScreen>:
    name: 'intro_screen'
    id: intro_screen
    orientation: 'vertical'
    pos_hint: {'center_y':0.5}
    adaptive_height: True
    IntroScreenLayout:
        # nav_drawer: nav_drawer

<LoginScreen>:
    name: 'login_screen'
    orientation: 'vertical'
    pos_hint: {'center_y':0.5}
    adaptive_height: True
    LoginScreenLayout:


<PasswordGeneratorScreen>:
    name: 'password_generator_screen'
    orientation: 'vertical'
    pos_hint: {'center_y':0.5}
    adaptive_height: True
    PasswordGeneratorScreenLayout:


<IntroScreenLayout>:
    orientation: 'vertical'
    pos_hint: {'center_y':0.5}
    adaptive_height: True
    spacing: "50dp"
    valign: 'center'
    padding: ["10dp", "10dp", "10dp", "10dp"]
    # nav_drawer: nav_drawer
    password_entered: password_1
    password_confirmation: password_2
    id: intro_screen_layout

    MDLabel:
        text: '\'Simple\' Password manager'
        # pos_hint: {'center_x': .5}
        halign: 'center'
        valign: 'center'
        font_style: 'H4'

    MDLabel:
        text: "It seems you have not set a master password. Please set it up."
        halign: 'center'
        valign: 'center'
        font_stlye: 'H5'

    MDTextField:
        id: password_1
        hint_text: 'Enter the password here.'
        valign: 'center'
        size_hint_x: 0.5
        pos_hint: {'center_x': .5}

    MDTextField:
        id: password_2
        hint_text: 'Enter the password again.'
        valign: 'center'
        size_hint_x: 0.5
        pos_hint: {'center_x': .5}

    MDRectangleFlatButton:
        text: "Click here to confirm"
        valign: 'center'
        halign: 'center'
        pos_hint: {'center_x': .5}
        on_press: root.validate_password()

    MDRectangleFlatButton:
        text: "Click here to remove the intro screen."
        valign: 'center'
        halign: 'center'
        pos_hint: {'center_x': .5}
        on_press: 
            root.parent.remove_screen(self)
            # root.parent.nav_drawer.navigation_content.remove_first_item()

<LoginScreenLayout>:
    password_entered: master_password
    orientation: 'vertical'
    pos_hint: {'center_y':0.5}
    size_hint_x: 1.0
    adaptive_height: True
    spacing: "50dp"
    valign: 'center'
    padding: ["10dp", "10dp", "10dp", "10dp"]

    MDLabel:
        text: '\'Simple\' Password manager'
        halign: 'center'
        valign: 'center'
        font_style: 'H4'
    
    MDTextField:
        id: master_password
        hint_text: 'Enter the master password.'
        valign: 'center'
        size_hint_x: 0.5
        pos_hint: {'center_x': .5}

    MDRectangleFlatButton:
        text: 'Validate'
        valign: 'center'
        size_hint_x: 0.5
        pos_hint: {'center_x': .5}
        on_press: root.validate_password()

<PasswordGeneratorScreenLayout>:
    orientation: 'vertical'
    pos_hint: {'center_y':0.5}
    size_hint_x: 1.0
    adaptive_height: True
    spacing: "50dp"
    valign: 'center'
    padding: ["10dp", "10dp", "10dp", "10dp"]
    password_field: password
    password_length: pass_length

    MDLabel:
        text: "Password generator"
        font_style: 'H3'
        halign: 'center'
        valign: 'center'

    MDBoxLayout:
        orientation: 'horizontal'
        pos_hint: {'center_x':0.5}
        size_hint_x: 0.8
        adaptive_height: True
        halign: 'center'
        valign: 'center'

        MDLabel:
            text: 'Enter the number of characters in your desired password.'
            pos_hint: {'center_y': 0.5}
        
        MDTextField:
            id: pass_length
            pos_hint: {'center_y': 0.5}
            size_hint_x: 0.2
            input_filter: "int"
            on_text_validate: root.generate_password_and_copy()

    MDLabel:
        id: password
        text: 'Your generated password will be displayed here.'
        pos_hint: {'center_x': 0.5}
        halign: 'center'
        # text_size: (200, None)
        # size_hint: (1, None)
        size_hint_y: None


    MDRectangleFlatButton:
        text: 'Generate password and copy to clipboard.'
        size_hint_x: 0.5
        pos_hint: {'center_x':0.5}
        halign: 'center'
        on_press: root.generate_password_and_copy()